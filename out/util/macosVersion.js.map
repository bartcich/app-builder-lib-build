{"version":3,"sources":["../../src/util/macosVersion.ts"],"names":[],"mappings":";;;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;AAEA,MAAM,YAAY,GAAG,KAAI,eAAJ,EAAiB,YAAW;AAC/C,QAAM,IAAI,GAAG,MAAM,0BAAS,kDAAT,EAA6D,MAA7D,CAAnB;AACA,QAAM,OAAO,GAAG,8DAA8D,IAA9D,CAAmE,IAAnE,CAAhB;;AACA,MAAI,CAAC,OAAL,EAAc;AACZ,UAAM,IAAI,KAAJ,CAAU,iCAAV,CAAN;AACD;;AACD,aAAI,KAAJ,CAAU;AAAC,IAAA,OAAO,EAAE,OAAO,CAAC,CAAD;AAAjB,GAAV,EAAiC,eAAjC;;AACA,SAAO,KAAK,CAAC,OAAO,CAAC,CAAD,CAAR,CAAZ;AACD,CARoB,CAArB;;AAUA,SAAS,KAAT,CAAe,OAAf,EAA8B;AAC5B,SAAO,OAAO,CAAC,KAAR,CAAc,GAAd,EAAmB,MAAnB,KAA8B,CAA9B,GAAkC,GAAG,OAAO,IAA5C,GAAmD,OAA1D;AACD;;AAED,eAAe,+BAAf,CAA+C,KAA/C,EAA4D;AAC1D,SAAO,MAAM,GAAC,GAAP,EAAW,MAAM,YAAY,CAAC,KAA9B,GAAqC,KAAK,CAAC,KAAD,CAA1C,CAAP;AACD;;AAEK,SAAU,eAAV,GAAyB;AAC7B,SAAO,YAAY,CAAC,KAApB;AACD;;AAEM,eAAe,aAAf,GAA4B;AACjC,SAAO,OAAO,CAAC,QAAR,KAAqB,QAArB,KAAiC,MAAM,+BAA+B,CAAC,SAAD,CAAtE,CAAP;AACD,C","sourcesContent":["import { readFile } from \"fs-extra-p\"\r\nimport { Lazy } from \"lazy-val\"\r\nimport * as semver from \"semver\"\r\nimport { log } from \"builder-util/out/log\"\r\n\r\nconst macOsVersion = new Lazy<string>(async () => {\r\n  const file = await readFile(\"/System/Library/CoreServices/SystemVersion.plist\", \"utf8\")\r\n  const matches = /<key>ProductVersion<\\/key>[\\s\\S]*<string>([\\d.]+)<\\/string>/.exec(file)\r\n  if (!matches) {\r\n    throw new Error(\"Couldn't find the macOS version\")\r\n  }\r\n  log.debug({version: matches[1]}, \"macOS version\")\r\n  return clean(matches[1])\r\n})\r\n\r\nfunction clean(version: string) {\r\n  return version.split(\".\").length === 2 ? `${version}.0` : version\r\n}\r\n\r\nasync function isOsVersionGreaterThanOrEqualTo(input: string) {\r\n  return semver.gte(await macOsVersion.value, clean(input))\r\n}\r\n\r\nexport function getMacOsVersion() {\r\n  return macOsVersion.value\r\n}\r\n\r\nexport async function isMacOsSierra() {\r\n  return process.platform === \"darwin\" && await isOsVersionGreaterThanOrEqualTo(\"10.12.0\")\r\n}"],"sourceRoot":""}
